# Bitmap October 2024

## Сборка

Makefile содержит несколько целей для сборки. Ниже представлено описание наиболее важных из них:

- `make console_app` - сборка интерактивного консольного приложения с подключением статической библиотеки для работы с bitmap, а также плагинов для выполнения побитовых операций;

- `LIB_TYPE=shared make console_app` - сборка интерактивного консольного приложения с подключением динамической библиотеки для работы с bitmap, а также плагинов для выполнения побитовых операций;

  > **Важно!** При пересборке интерактивного приложения под другой тип (со статики на динамику или наоборот) необходимо предварительно выполнить команду `make clean`. Это нужно для правильной работы плагинов.

- `make test` - сборка автотестов;

Дополнительные возможности:

- `make mem` - проверка автотестов на наличие утечек памяти;

- `LIB_TYPE=shared make lib` - сборка динамической библиотеки;

- `make lib` - сборка статической библиотеки;

- `make plugins` - сборка плагинов для работы с побитовыми операциями;

- `make coverage` - создание отчета о проценте покрытия кода тестами;

- `doxygen Doxyfile` - создание html документации проекта.

## Запуск

1. Соберите бинарный файл, выполнив нужную цель из Makefile;
2. Перейдите в папку `build`, там появятся все бинарные файлы и библиотеки;
3. Запустите нужный бинарный файл:
    - `./<название_файла>` - запуск бинарных файлов, собранных статически. К таким файлам относится, например, результат выполнения команды `make test`. Пример запуска:
      ```bash
      ./check
      ```

    - Если бинарный файл был собран для работы с динамическими библиотеками, то необходимо использовать команду:

        ```bash
        LD_LIBRARY_PATH=$PWD:$LD_LIBRARY_PATH ./<название_файла>
        ```

        К таким файлам относится, например, результат выполнения команд `make console_app` и `LIB_TYPE=shared make console_app`, т.к. в обоих случаях динамически подключаются плагины. Пример запуска:

        ```bash
        LD_LIBRARY_PATH=$PWD:$LD_LIBRARY_PATH ./console_app_static
        LD_LIBRARY_PATH=$PWD:$LD_LIBRARY_PATH ./console_app_shared
        ```

Существует возможность запустить готовый сценарий для проверки работы приложения. Для этого, находясь в папке `build`, введите команду:

```bash
LD_LIBRARY_PATH=$PWD:$LD_LIBRARY_PATH ../autorun.sh ./console_app_static
LD_LIBRARY_PATH=$PWD:$LD_LIBRARY_PATH ../autorun.sh ./console_app_shared
```
> Для запуска необходима утилита управления вводом `expect`:  
> `sudo apt install expect`

Библиотека для работы с bitmap поддерживает логирование. Для включения этой опции необходимо при сборке указать **один или несколько** вариантов логирования:
- `LOG_TO_FILE` - логирование в файл `log.txt`, который появится в директории запуска;
- `LOG_TO_STDERR` - логирование в стандартный поток ошибок;
- `LOG_TO_SYSLOG` - логирование в системный журнал. Его можно посмотреть, например, выполнив команду `tail -n 50 /var/log/syslog`.

Примеры сборки приложения с разными вариантами логирования:
```bash
LOG="-DLOG_TO_FILE -DLOG_TO_STDERR -DLOG_TO_SYSLOG" make console_app
LOG="-DLOG_TO_FILE -DLOG_TO_SYSLOG" LIB_TYPE=shared make console_app
```

## Возможности

Интерактивное консольное приложение реализует все возможности работы с bitmap, представленные в техническом задании. Ниже представлена иерархия пунктов меню приложения с кратким описанием:

- **1. Добавить bitmap** — позволяет создать новый bitmap и добавить его в массив;
- **2. Удалить bitmap** — удаляет существующий bitmap из массива;
- **3. Список bitmap** — выводит список всех созданных bitmap-ов с их состоянием и параметрами;
- **4. Изменить bitmap** — позволяет редактировать параметры существующего bitmap-а;
- **5. Битовые операции** — открывает подменю для выполнения логических битовых операций (AND, OR, XOR, NOT) над bitmap-ами (**более короткий bitmap добивается нулями слева**):
  - **5.1 Выполнить AND** — выполняет операцию побитового "И" (AND) между bitmap-ами;
  - **5.2 Выполнить OR** — выполняет побитовое "ИЛИ" (OR) между bitmap-ами;
  - **5.3 Выполнить XOR** — выполняет операцию побитового исключающего ИЛИ (XOR);
  - **5.4 Выполнить NOT** — выполняет операцию побитового отрицания (NOT) над bitmap-ом;
  - **5.5 Назад** — возвращает в главное меню;
- **6. Операции сравнения** — открывает подменю для выполнения операций сравнения между bitmap-ами (**более короткий bitmap добивается нулями слева**):
  - **6.1 Операция >** — проверяет, больше ли один bitmap другого;
  - **6.2 Операция <** — проверяет, меньше ли один bitmap другого;
  - **6.3 Операция =** — проверяет, равны ли два bitmap-а;
  - **6.4 Операция >=** — проверяет, больше или равен один bitmap другому;
  - **6.5 Операция <=** — проверяет, меньше или равен один bitmap другому;
  - **6.6 Назад** — возвращает в главное меню;
- **7. Копировать bitmap** — вставляет выбранную часть bitmap-а источника в нужное место bitmap-а назначения;
- **8. Клонировать bitmap** — создает глубокую копию bitmap-а с сохранением состояния;
- **9. Склеить два bitmap** — объединяет два bitmap-а в один, результат сохраняется в новом bitmap-е;
- **10. Сбросить bitmap** — сбрасывает биты выбранного bitmap-а;
- **11. Выход** — завершает выполнение программы.
